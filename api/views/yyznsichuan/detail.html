<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>一路同行共盼花开</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <style type="text/css">
        body{
            margin: 0;
            font-size: 0;
        }
        img{
            margin: 0px;
            padding: 0px;
            width: 100%;
        }
    </style>
</head>

<body>
    <img src="https://bdn.135editor.com/files/202002/yyzn/back1.jpg"><img src="https://bdn.135editor.com/files/202002/yyzn/back2.jpg" data-toggle="modal" data-target="#followModal" onclick="getQrcode()"><img src="https://bdn.135editor.com/files/202002/yyzn/back3.jpg">

    <!-- <div class="cover-bg">
        <div class="btn">
            <img src="https://bdn.135editor.com/files/202002/yyzn/btn.png" data-toggle="modal" data-target="#followModal" onclick="getQrcode()">
        </div> -->
        <!-- <div class="qrcode">
            <img src="https://bdn.135editor.com/files/202002/yyzn/qrcode.jpg" >
        </div> -->
    <!--     <img src="https://bdn.135editor.com/files/202002/yyzn/back.jpg">
    </div> -->

    <div class="modal fade" id="followModal" tabindex="-1" role="dialog" aria-labelledby="followModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content qrcode">
                <div class="modal-body" id="qrcodebox">
                    <div style="text-align: center;margin: 0.7rem;width:96%">
                        正在为您生成海报请稍等...
                    </div>
                </div>
                <input type="hidden" id="qrcodestatus" value="off">
                <div class="modal-footer qrcode-text" style="font-size:14px;text-align: center;">
                    长按保存图片, 发给好友或者朋友圈
                </div>
            </div>
        </div>
    </div>
    <style type="text/css">
        /*body{
            margin: 0;
        }
        .qrcode-text{
            text-align: center;
        }
        .cover-bg { position: relative; width: 414px; margin: 0 auto; height: auto; }
        .cover-bg img { width: 100%; }
        .cover-bg .btn { position: absolute; z-index: 2; width: 200px; top: 52%; left: 50%; margin-left: -100px; }
        .cover-bg .btn img { width: 100%; }
        .cover-bg .qrcode { position: absolute; z-index: 2; width: 140px; left: 50%; margin-left: -76px; bottom: 11.5%; }
        .cover-bg .qrcode img { width: 100%; }
        @media only screen and ( max-width: 479px ) {
            .cover-bg { width: 100%; }
        }

        @media only screen and ( max-width: 375px ) {
            .cover-bg { width: 100%; }
            .cover-bg .btn { width: 170px; margin-left: -85px; top: 57%; }
            .cover-bg .qrcode { width: 120px; margin-left: -60px; }
        }

        @media only screen and ( max-width: 320px ) {
            .cover-bg { width: 100%; }
            .cover-bg .btn { width: 200px; margin-left: -99px; top: 52%; }
            .cover-bg .qrcode { width: 100px; margin-left: -50px; }
        }*/
    </style>
</body>
{{ assets.outputJs() }}
<script type="text/javascript">
    getWeChatSign();
    function getWeChatSign() {
        $.ajax({
            url: "/new/yyzn/getSignPackage",
            type: 'post',
            success: function(res) {
                console.log(res);
                if (res.code == 200) {
                    var resData = res.data;
                    wx.config({
                        debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                        appId: resData.appId, // 必填，公众号的唯一标识
                        timestamp: resData.timestamp, // 必填，生成签名的时间戳
                        nonceStr: resData.nonceStr, // 必填，生成签名的随机串
                        signature: resData.signature, // 必填，签名
                        jsApiList: ["onMenuShareTimeline", // 分享给好友
                            "onMenuShareAppMessage", // 分享到朋友圈
                            "onMenuShareAppMessage", // 分享到朋友圈
                            "hideMenuItems",
                        ] // 必填，需要使用的JS接口列表
                    });
                }
            },
            error: function(data) {
                console.log(JSON.stringify(data));
            }
        });

        wx.ready(function() {
            wx.hideMenuItems({
                menuList: ["menuItem:copyUrl", "menuItem:editTag", "menuItem:delete", "menuItem:originPage", "menuItem:readMode", "menuItem:openWithQQBrowser", "menuItem:openWithSafari", "menuItem:share:email", "menuItem:share:brand", "menuItem:share:qq", "menuItem:share:QZone"] // 要隐藏的菜单项，只能隐藏“传播类”和“保护类”按钮
            });
            wx.onMenuShareTimeline({
                title: "{{ share['title'] }}",
                link: "{{ share['url'] }}",
                imgUrl: "{{ share['image']}}",
                success: function() {}
            });
            wx.onMenuShareAppMessage({
                title: "{{ share['title'] }}",
                desc: "{{ share['desc']}}", // 这里请特别注意是要去除html
                link: "{{ share['url'] }}",
                imgUrl: "{{ share['image']}}",
                type: '',
                success: function() {}
            });
        });
    }
    function getQrcode() {
        var status = $("#qrcodestatus").val();
        if(status == 'on'){
            return false;
        }
        $.ajax({
            url: '/new/yyznsichuan/createImage',
            type: 'GET',
            success: function(res) {
                if (res.code == 200) {
                        $("#qrcodestatus").val('on');
                        var qrcodestr = '<img src="'+res.data.image_url+'" class="img-responsive img-thumbnail">';
                        $('#qrcodebox').html(qrcodestr);
                }else{
                    var qrcodestr = '<div style="text-align: center;margin: 0.7rem;width:96%">'+res.info+'...</div>';
                    $('#qrcodebox').html(qrcodestr);
                }
            }
        });
    }
</script>
</html>